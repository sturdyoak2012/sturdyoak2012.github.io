<!DOCTYPE html>
<head>
	<title>Orbits</title>
		<link rel="shortcut icon" type="image/png" href="../favicon.png"/>
	<link rel="stylesheet" href="../style.css">
	<script type="text/javascript" async
  		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
	</script>
	<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-database.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyA7-t4UBOoWgYq65D74vbluIwuuDotKlG8",
    authDomain: "jacobnie-4a6fd.firebaseapp.com",
    databaseURL: "https://jacobnie-4a6fd.firebaseio.com",
    projectId: "jacobnie-4a6fd",
    storageBucket: "jacobnie-4a6fd.appspot.com",
    messagingSenderId: "202057575155"
  };
  firebase.initializeApp(config);
</script>

<script>

  var request = new XMLHttpRequest();
  request.open('GET', 'https://ipapi.co/json', true);
  request.onload = function () {
    if (request.status >= 200 && request.status < 400) {
      // Success!
      var data = JSON.parse(request.responseText);
      
        firebase.database().ref("/analytics/").child(btoa(data.ip)).child("visits").once("value").then(function(snapshot) {
        	firebase.database().ref("/analytics/").child(btoa(data.ip)).update({
        		visits:(snapshot.val()||0) + 1,
        		data:data,
				lastVisit:{
	          		page:window.location.pathname,
	          		timestamp:new Date() + ""
	          	}
	        });
	        firebase.database().ref("/analytics/").child(btoa(data.ip)).child("history").push({
	          	page:window.location.pathname,
	          	timestamp:new Date() + ""
	          });
        })
      
    }
  };
  request.onerror = function () {
    // There was a connection error of some sort
  };
  request.send();
</script>
</head>
<body>
<div id="container">
<div id="menu">
	<a href='../index.html'><div id='jacob'><p>Jacob Nie</p></div></a>
	<a href='../about.html'><div id='pages'><p>about</p></div></a>
	<a href='../pictures.html'><div id='pages'><p>pictures</p></div></a>
	<a href='../outdoors.html'><div id='pages'><p>outdoors</p></div></a>
	<a href='../physics.html'><div id='pages'><p>physics</p></div></a>
</div>
<div id="page">
<div class="trip">
Some messing around with n-body simulations (very casual) 1/16/19
<h3>Program</h3>
Using MATLAB, I wrote a simple equal mass 3-body system simulation.  There are several options for the method of integration, I tried out these four: (Let $a(r)$ be the acceleration of the body when it has the position vector $r$, and $a,v,$ and $r$ are all vectors and $h$ is the time step)
<ul>
	<li>Euler's method: $k = a(r_i), $$v_{i+1} = v_i + kh, $$r_{i+1} = r + v_i h.$</li>
	<li>Implicit midpoint method: $k = a(r_i), v_{i+1} = v_i + kh,$$r_{i+1} = r + \frac{1}{2}(v_i+v_{i+1})h$</li>
	<li>Leapfrog method (Verlet velocity method): $k_1 = a(r_i), $$r_{i+1} = r_i + v_i h + \frac{1}{2}k_1 h^2, $$k_2 = a(r_{i+1}),$$ v_{i+1}=v_i+\frac{1}{2}(k_1+k_2)h$</li>
	<li>4th-order Runge Kutta method: $k_{v1} = a(r_i),\quad$$k_{r1}=v_i,\quad$$k_{v2} = a(r_i+\frac{1}{2}k_{r1}h),\quad$$k_{r2}=v_i+\frac{1}{2}k_{v1}h,\quad$$k_{v3} = a(r_i + \frac{1}{2}k_{r2}h),\quad$$k_{r3} = v_i + \frac{1}{2}k_{v2}h,\quad$$k_{v4} = a(r_i + k_{r3}h),\quad$$k_{r4} = v_i + k_{v3}h,\quad$$v_{i+1} = v_i + \frac{1}{6}(k_{v1}+2k_{v2}+2k_{v3}+k_{v4})h,\quad$$r_{i+1} = r_i + \frac{1}{6}(k_{r1}+2k_{r2}+2k_{r3}+k_{r4})h.$</li>
</ul>
(In my algorithm I calculate acceleration using Newton's law of gravity assuming $G,M=1.$)

My understanding of the math isn't really good enough to explain why one is better than the other, so I decided to test them against each other for a few cases.  Since the 3-body system is chaotic, the accuracy of the model matters quite a lot.  Here is a table comparing these 4 integration methods at different time-steps:
<br><br>
<img style="width:100%" src="orb_img/99.svg">
<br><br>
<a href="orb_img/99.svg">Full size.</a>  The initial conditions were:
<ul>
	<li>red: $r=(0,0,0),v=(0,-1,0)$</li>
	<li>green: $r=(1,0,0),v=(0,0,0)$</li>
	<li>blue: $r=(0.5,0,0),v=(0,1,0)$</li>
</ul>
As you can see, there is a lot of difference.  This is because the initial conditions were set up for three "close encounters," and these have the tendency to magnify any deviations.  The behavior of the system is pretty hard to predict mostly for that reason. 
<br><br>
The accuracy of each method can be tested against the simple case of a mass orbiting another, stationary, mass.  
<br><br>
<img style="width:100%" src="orb_img/circle.svg">
<a href="orb_img/circle.svg">Full size.</a>  Key: green - correct orbit (circle); red - Runge Kutta; blue - leapfrog; blue* - midpoint; red* - Euler.
<br><br>
Initial conditions were $r=(-1,0,0),v=(0,1,0).$  Iterated over a time of 10 seconds with timestep 0.3 seconds.  Here it's clear that the Runge-Kutta method has the least error.  However, the leapfrog method has the advantage of remaining in a stable orbit, whereas the Runge-Kutta method tends to decay:
<img style="width:100%" src="orb_img/12.svg">
<br><br>
<a href="orb_img/12.svg">Full size.</a>  Initial conditions: same as above.  Iterated over a time of 10000 seconds with timestep 0.3 seconds.  
<br><br>
An obvious next step is to look for some nicely periodic, bounded systems.  Here is one I stumbled upon:
<br><br>
Initial conditions: $r_a=(0,0,0), v_a = (0,-1.5,0), r_b = (0.5,0,0), v_b = (0, 1.5, 0), r_c = (1,0,0), v_c=(0,0,0)$
<br><br>
Animation:
<br><br>
<img style="width:auto" src="orb_img/asd.gif">
<br><br>
I am not sure if the exact configuration remains periodic in the long term, because the simulations show that it explodes eventually:
<br><br>
<img src="orb_img/spirals1.svg">
<br><br>
(Calculated with the leapfrog method for timestep 0.001 and total time 100, with initial conditions as specified above.)








</div>
</div>
</div>
</body>
